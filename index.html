<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>동작확인</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Do+Hyeon&display=swap');

        * {
            font-family: "Do Hyeon", sans-serif;
            font-weight: 400;
            font-style: normal;
        }
    </style>
    <script type="module">
        // Firebase SDK 라이브러리 가져오기
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import {
            getFirestore, collection, addDoc, getDocs,
            doc, updateDoc, increment, getDoc
        } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";


        // Firebase 구성 정보 설정
        const firebaseConfig = {
            apiKey: "AIzaSyC6n_NFwSRQr8vbpriDJ3nMAvX31z_wP1I",
            authDomain: "introduce-606f9.firebaseapp.com",
            projectId: "introduce-606f9",
            storageBucket: "introduce-606f9.firebasestorage.app",
            messagingSenderId: "94396344619",
            appId: "1:94396344619:web:0384e74c40dcbd1ca1fd6e",
            measurementId: "G-KNFJY5H08H"
        };


        // Firebase 인스턴스 초기화
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const likeDocRef = doc(db, "LIKE", "LIKECOUNT");
        const likeDocRef2 = doc(db, "LIKE", "COMMENTLIKE");

        async function fetchCount1() {
            const docSnap = await getDoc(likeDocRef);
            if (docSnap.exists()) {
                document.getElementById("count").textContent = docSnap.data().count ?? 0;

                const likeBtn = document.getElementById("LIKEBTN");
                likeBtn.querySelector("#heart").textContent = docSnap.data().count >= 1 ? "♥" : "♡";
            }
        }

        fetchCount1();


        document.getElementById("LIKEBTN").addEventListener("click", async () => {
            await updateDoc(likeDocRef, {
                count: increment(1)
            });
            fetchCount1();
        });

        async function fetchCount2() {
            const docSnap = await getDoc(likeDocRef2);
            if (docSnap.exists()) {
                document.getElementById("count2").textContent = docSnap.data().count ?? 0;

                const likeBtn = document.getElementById("LIKEBTN2");
                likeBtn.querySelector("#heart2").textContent = docSnap.data().count >= 1 ? "♥" : "♡";
            }
        }

        fetchCount2();


        document.getElementById("LIKEBTN2").addEventListener("click", async () => {
            await updateDoc(likeDocRef2, {
                count: increment(1)
            });
            fetchCount2();
        });


    </script>
</head>

<body>
    <div>
        <p class="title">자기소개글 좋아요</p>
    </div>
    <div class="LIKE" style="margin-bottom: 40px;">
        <button id="LIKEBTN" type="button" class="rounded-pill" class="btn btn-outline-dark"><span id="heart"
                style="color: red; margin-right: 2px;">♡</span> 좋아요 <span id="count"
                style="margin-left: 6px;">0</span></button>
    </div>
    <div>
        <p class="title">댓글 좋아요</p>
    </div>
    <div class="LIKE2">
        <button id="LIKEBTN2" type="button" class="rounded-circle" class="btn btn-outline-dark"><span id="heart2"
                style="color: red; margin-right: 2px;">♡</span><span id="count2">0</span></button>
    </div>
</body>

</html>